<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê¹€í˜•íƒœë‹˜ì˜ AI ì½”ë”© í¬íŠ¸í´ë¦¬ì˜¤</title>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    
    <!-- Firebase SDK (Compat) -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

    <link href="https://fonts.googleapis.com/css2?family=Jua&family=Noto+Sans+KR:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans KR', sans-serif; background-color: #f8fafc; }
        .font-jua { font-family: 'Jua', sans-serif; }
        .card-hover:hover { transform: translateY(-5px); box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1); }
        .admin-btn { position: fixed; bottom: 20px; right: 20px; z-index: 50; }
        /* Modal Animation */
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .modal-overlay { animation: fadeIn 0.3s ease-out; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // ==========================================
        // [ì„¤ì • êµ¬ì—­] Firebase ì„¤ì •
        // ==========================================
        const firebaseConfig = {
            apiKey: "AIzaSyBiMp5UEmNviSazPRxb-5L60jJnELZL6S0",
            authDomain: "ai-coding-collection.firebaseapp.com",
            projectId: "ai-coding-collection",
            storageBucket: "ai-coding-collection.firebasestorage.app",
            messagingSenderId: "572754851302",
            appId: "1:572754851302:web:22050169bb98eebaa3d227"
        };

        // Firebase ì´ˆê¸°í™”
        let db = null;
        if (firebaseConfig.apiKey) {
            firebase.initializeApp(firebaseConfig);
            db = firebase.firestore();
        }

        // ê¸°ë³¸ ë°ëª¨ ë°ì´í„°
        const DEMO_PROJECTS = [
            { id: 1, title: "ëª¨ì˜íˆ¬ì ë™ì•„ë¦¬ ì•±", desc: "Reactì™€ Stateë¥¼ í™œìš©í•´ ë§Œë“  ì£¼ì‹ ë§¤ë§¤ ì‹œë®¬ë ˆì´ì…˜", icon: "ğŸ“ˆ", color: "bg-purple-100 text-purple-600", link: "./Lv4_S01_Stock.html" },
            { id: 2, title: "ìš°ë¦¬ ë°˜ ê¸‰ì‹í‘œ", desc: "ìš”ì¼ë³„ ê¸‰ì‹ ë©”ë‰´ë¥¼ í™•ì¸í•˜ê³  ì¢‹ì•„ìš”ë¥¼ ëˆ„ë¥´ëŠ” ì•±", icon: "ğŸ±", color: "bg-orange-100 text-orange-600", link: "./Lv4_S02_Lunch.html" },
            { id: 3, title: "ì˜ì›í•œ ë°©ëª…ë¡", desc: "ìƒˆë¡œê³ ì¹¨í•´ë„ ì‚¬ë¼ì§€ì§€ ì•ŠëŠ” ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ DB ì‹¤ìŠµ", icon: "ğŸ“", color: "bg-yellow-100 text-yellow-600", link: "./Lv5_S01_Guestbook.html" },
            { id: 4, title: "AI ë´‡ ì±„íŒ…ë°©", desc: "ì‹¤ì‹œê°„ìœ¼ë¡œ ëŒ€í™”í•˜ëŠ” ë“¯í•œ ì±„íŒ… UI êµ¬í˜„", icon: "ğŸ’¬", color: "bg-blue-100 text-blue-600", link: "./Lv5_S02_Chat.html" },
            { id: 5, title: "ìˆ˜ë£Œì¦ ë°œê¸‰ê¸°", desc: "ê³¼ì •ì„ ë§ˆì¹˜ê³  ì´ë¦„ì„ ì…ë ¥í•˜ë©´ ìƒì¥ì´ ë‚˜ì˜¤ëŠ” ì•±", icon: "ğŸ“", color: "bg-green-100 text-green-600", link: "./Lv6_S02_Graduation.html" }
        ];

        const App = () => {
            const [projects, setProjects] = useState(DEMO_PROJECTS);
            const [copiedId, setCopiedId] = useState(null);
            const [isAdminOpen, setIsAdminOpen] = useState(false);
            const [isAdmin, setIsAdmin] = useState(false);
            const [password, setPassword] = useState("");
            const [uploadStatus, setUploadStatus] = useState("");
            const fileInputRef = useRef(null);

            useEffect(() => {
                if (db) {
                    const unsubscribe = db.collection("portfolio").orderBy("id").onSnapshot((snapshot) => {
                        const dbProjects = snapshot.docs.map(doc => ({ ...doc.data(), docId: doc.id }));
                        if(dbProjects.length > 0) setProjects(dbProjects);
                    });
                    return () => unsubscribe();
                }
            }, []);

            const copyToClipboard = (link, id) => {
                const fullUrl = new URL(link, window.location.href).href;
                navigator.clipboard.writeText(fullUrl).then(() => {
                    setCopiedId(id);
                    setTimeout(() => setCopiedId(null), 2000);
                });
            };

            const checkPassword = () => {
                if (password === "1230") {
                    setIsAdmin(true);
                    setPassword("");
                } else {
                    alert("ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤!");
                }
            };

            // CSV íŒŒì¼ ì²˜ë¦¬ (ê°œì„ ë¨)
            const handleFileUpload = (e) => {
                const file = e.target.files[0];
                if (!file) return;

                if (!db) {
                    alert("Firebase ì„¤ì • ì˜¤ë¥˜: DBì— ì €ì¥í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
                    return;
                }

                const reader = new FileReader();
                reader.onload = async (event) => {
                    let text = event.target.result;
                    
                    // 1. BOM ì œê±° (ì—‘ì…€ ì €ì¥ ì‹œ ìƒê¸°ëŠ” íŠ¹ìˆ˜ë¬¸ì ì œê±°)
                    text = text.replace(/^\uFEFF/, ''); 

                    const rows = text.split('\n').slice(1); // í—¤ë” ì œì™¸
                    
                    setUploadStatus("ë°ì´í„° ë¶„ì„ ì¤‘...");
                    const batch = db.batch();
                    let count = 0;

                    rows.forEach((row, index) => {
                        // 2. ë”°ì˜´í‘œ ì œê±° ë° ê³µë°± ì •ë¦¬
                        // ì‰¼í‘œë¡œ ë‚˜ëˆ„ë˜, ë°ì´í„° ì•ˆì˜ ì‰¼í‘œëŠ” ì²˜ë¦¬í•˜ì§€ ëª»í•˜ë¯€ë¡œ ê°„ë‹¨í•˜ê²Œ split ì‚¬ìš©
                        // (ë³µì¡í•œ CSVëŠ” ì—‘ì…€ì—ì„œ ì‰¼í‘œë¥¼ ë‹¤ë¥¸ ë¬¸ìë¡œ ë°”ê¿”ì„œ ì €ì¥í•˜ëŠ” ê²Œ ì•ˆì „í•¨)
                        const cols = row.split(',').map(item => item ? item.trim().replace(/^"|"$/g, '') : '');
                        
                        if (cols.length >= 5 && cols[0]) {
                            const newDocRef = db.collection("portfolio").doc();
                            
                            // 3. ìƒ‰ìƒ í´ë˜ìŠ¤ê°€ ë¹„ì–´ìˆìœ¼ë©´ ê¸°ë³¸ê°’ ì§€ì •
                            const colorClass = cols[3] || "bg-gray-100 text-gray-600";
                            
                            batch.set(newDocRef, {
                                id: Date.now() + index,
                                title: cols[0],
                                desc: cols[1],
                                icon: cols[2], // ì´ëª¨ì§€
                                color: colorClass,
                                link: cols[4]
                            });
                            count++;
                        }
                    });

                    if (count === 0) {
                        setUploadStatus("ì¶”ê°€í•  ë°ì´í„°ê°€ ì—†ê±°ë‚˜ í˜•ì‹ì´ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤.");
                        return;
                    }

                    try {
                        await batch.commit();
                        setUploadStatus(`${count}ê°œ ì—…ë¡œë“œ ì„±ê³µ! ğŸ‰`);
                        setTimeout(() => setUploadStatus(""), 3000);
                        if(fileInputRef.current) fileInputRef.current.value = "";
                    } catch (error) {
                        console.error(error);
                        setUploadStatus("ì—…ë¡œë“œ ì¤‘ ì˜¤ë¥˜ ë°œìƒ ğŸ˜­");
                    }
                };
                reader.readAsText(file);
            };

            const deleteProject = async (docId) => {
                if (!db) return alert("ë°ëª¨ ëª¨ë“œì…ë‹ˆë‹¤.");
                if (confirm("ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
                    await db.collection("portfolio").doc(docId).delete();
                }
            };

            return (
                <div className="min-h-screen pb-20">
                    {/* Header */}
                    <div className="bg-indigo-600 text-white pt-20 pb-24 px-4 text-center relative overflow-hidden">
                        <div className="absolute top-0 left-0 w-full h-full opacity-10">
                            <i className="ph-fill ph-code text-9xl absolute -top-10 -left-10"></i>
                            <i className="ph-fill ph-brackets-curly text-9xl absolute bottom-0 right-0"></i>
                        </div>
                        <h1 className="text-4xl md:text-5xl font-bold font-jua mb-4 relative z-10">
                            ê¹€í˜•íƒœì˜ ì½”ë”© í¬íŠ¸í´ë¦¬ì˜¤
                        </h1>
                        <p className="text-indigo-200 text-lg max-w-2xl mx-auto relative z-10">
                            AI (Claude, ChatGPT, ì œë¯¸ë‚˜ì´) ë„ìš°ë¯¸ë“¤ê³¼ í•¨ê»˜ ë§Œë“ <br/>
                            ì¬ë¯¸ìˆê³  ì°½ì˜ì ì¸ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ì»¬ë ‰ì…˜ì…ë‹ˆë‹¤.
                        </p>
                    </div>

                    {/* Content */}
                    <div className="max-w-6xl mx-auto px-4 -mt-16 relative z-20">
                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                            
                            {/* Profile Card */}
                            <div className="bg-white rounded-2xl shadow-xl p-6 flex flex-col items-center text-center border-t-4 border-indigo-500">
                                <div className="w-24 h-24 rounded-full overflow-hidden border-4 border-white shadow-lg -mt-16 mb-4 bg-gray-200 shrink-0">
                                    <img src="https://api.dicebear.com/9.x/avataaars/svg?seed=Professor&clothing=blazerAndShirt&glasses=round" 
                                         alt="Profile" className="w-full h-full object-cover" />
                                </div>
                                <h2 className="text-xl font-bold text-gray-800 font-jua">ê¹€í˜•íƒœ</h2>
                                <p className="text-sm text-gray-500 mb-4">ìš°ì†¡ëŒ€í•™êµ AIê²½ì˜í•™ê³¼ í•™ê³¼ì¥</p>
                                <div className="flex gap-2 mb-4 justify-center flex-wrap">
                                    <span className="px-3 py-1 bg-gray-100 rounded-full text-xs font-bold text-gray-600">#React</span>
                                    <span className="px-3 py-1 bg-gray-100 rounded-full text-xs font-bold text-gray-600">#AI</span>
                                    <span className="px-3 py-1 bg-gray-100 rounded-full text-xs font-bold text-gray-600">#Edu</span>
                                </div>
                                <a href="mailto:contact@example.com" className="w-full py-2 border border-gray-300 rounded-lg text-sm font-bold text-gray-600 hover:bg-gray-50 transition">
                                    <i className="ph-bold ph-envelope-simple mr-2"></i> ì—°ë½í•˜ê¸°
                                </a>
                            </div>

                            {/* Project Cards */}
                            {projects.map((project) => (
                                <div key={project.id} className="bg-white rounded-2xl shadow-lg p-6 flex flex-col justify-between card-hover transition-all duration-300 relative group h-full">
                                    {/* Delete Button */}
                                    {isAdmin && db && project.docId && (
                                        <button 
                                            onClick={(e) => { e.preventDefault(); deleteProject(project.docId); }}
                                            className="absolute top-2 right-2 bg-red-100 text-red-500 w-8 h-8 flex items-center justify-center rounded-full hover:bg-red-500 hover:text-white transition z-30"
                                            title="ì‚­ì œ"
                                        >
                                            <i className="ph-bold ph-trash"></i>
                                        </button>
                                    )}

                                    <div className="flex flex-col flex-1">
                                        <div className={`w-14 h-14 rounded-2xl flex items-center justify-center text-3xl mb-4 shrink-0 ${project.color || 'bg-gray-100'}`}>
                                            {project.icon || 'ğŸ“'}
                                        </div>
                                        <h3 className="text-xl font-bold text-gray-800 mb-2 font-jua break-keep">
                                            {project.title}
                                        </h3>
                                        <p className="text-gray-600 text-sm mb-6 leading-relaxed break-keep flex-1">
                                            {project.desc}
                                        </p>
                                    </div>
                                    
                                    <div className="flex gap-2 mt-auto shrink-0">
                                        <a href={project.link} target="_blank" className="flex-1 bg-gray-900 text-white py-2.5 rounded-xl font-bold text-sm hover:bg-gray-800 transition flex items-center justify-center gap-2">
                                            <i className="ph-bold ph-play-circle text-lg"></i> ì‹¤í–‰í•˜ê¸°
                                        </a>
                                        <button 
                                            onClick={() => copyToClipboard(project.link, project.id)}
                                            className={`w-12 h-10 rounded-xl flex items-center justify-center transition border ${copiedId === project.id ? 'bg-green-50 border-green-200 text-green-600' : 'bg-white border-gray-200 text-gray-500 hover:bg-gray-50'}`}
                                            title="ë§í¬ ë³µì‚¬"
                                        >
                                            {copiedId === project.id ? <i className="ph-bold ph-check"></i> : <i className="ph-bold ph-link"></i>}
                                        </button>
                                    </div>
                                </div>
                            ))}

                        </div>
                    </div>

                    <footer className="text-center mt-20 text-gray-400 text-sm">
                        &copy; 2024 Kim Hyung Tae Portfolio. All rights reserved.
                    </footer>

                    {/* Admin Button */}
                    <button 
                        onClick={() => setIsAdminOpen(true)}
                        className="admin-btn bg-gray-200 text-gray-500 hover:bg-gray-800 hover:text-white p-3 rounded-full shadow-lg transition-all opacity-50 hover:opacity-100"
                    >
                        <i className="ph-fill ph-gear text-xl"></i>
                    </button>

                    {/* Admin Modal */}
                    {isAdminOpen && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 modal-overlay backdrop-blur-sm">
                            <div className="bg-white rounded-2xl p-8 max-w-md w-full shadow-2xl relative">
                                <button onClick={() => setIsAdminOpen(false)} className="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                                    <i className="ph-bold ph-x text-xl"></i>
                                </button>

                                <h2 className="text-2xl font-bold font-jua mb-6 text-center text-gray-800">
                                    <i className="ph-fill ph-lock-key text-yellow-500 mr-2"></i>
                                    ê´€ë¦¬ì ëª¨ë“œ
                                </h2>

                                {!isAdmin ? (
                                    <div className="space-y-4">
                                        <p className="text-center text-gray-600 text-sm">ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”.</p>
                                        <input 
                                            type="password" 
                                            value={password}
                                            onChange={(e) => setPassword(e.target.value)}
                                            onKeyPress={(e) => e.key === 'Enter' && checkPassword()}
                                            className="w-full p-3 border border-gray-300 rounded-lg text-center font-bold tracking-widest focus:border-indigo-500 focus:outline-none"
                                            placeholder="****"
                                        />
                                        <button onClick={checkPassword} className="w-full bg-indigo-600 text-white py-3 rounded-lg font-bold hover:bg-indigo-700 transition">
                                            í™•ì¸
                                        </button>
                                    </div>
                                ) : (
                                    <div className="space-y-6">
                                        <div className="bg-green-50 p-4 rounded-xl border border-green-200 text-center">
                                            <p className="text-green-700 font-bold mb-2">CSV ì¼ê´„ ì—…ë¡œë“œ</p>
                                            <p className="text-xs text-gray-500 mb-4">
                                                íŒŒì¼ í˜•ì‹: ì œëª©,ì„¤ëª…,ì•„ì´ì½˜,ìƒ‰ìƒ,ë§í¬<br/>
                                                (ì‰¼í‘œë¡œ êµ¬ë¶„, ë”°ì˜´í‘œ ìë™ ì œê±°ë¨)
                                            </p>
                                            <input 
                                                type="file" 
                                                accept=".csv"
                                                ref={fileInputRef}
                                                onChange={handleFileUpload}
                                                className="block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-green-100 file:text-green-700 hover:file:bg-green-200 cursor-pointer"
                                            />
                                            {uploadStatus && <p className="mt-2 text-sm font-bold text-indigo-600">{uploadStatus}</p>}
                                        </div>
                                        
                                        <button onClick={() => { setIsAdmin(false); setIsAdminOpen(false); }} className="w-full bg-gray-200 text-gray-700 py-2 rounded-lg font-bold hover:bg-gray-300">
                                            ê´€ë¦¬ì ë¡œê·¸ì•„ì›ƒ
                                        </button>
                                    </div>
                                )}
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
